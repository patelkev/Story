This is chapter 4 currently in master branch.